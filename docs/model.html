---

title: Model Architecture


keywords: fastai
sidebar: home_sidebar

summary: "Module to prepare data for experiments"
description: "Module to prepare data for experiments"
nb_path: "02_model.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_model.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Prepare-dataloaders">Prepare dataloaders<a class="anchor-link" href="#Prepare-dataloaders"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Embeddings">Embeddings<a class="anchor-link" href="#Embeddings"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_emb_sz" class="doc_header"><code>get_emb_sz</code><a href="https://github.com/fastai/fastai/tree/master/fastai/tabular/model.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_emb_sz</code>(<strong><code>to</code></strong>, <strong><code>sz_dict</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get default embedding size from <code>TabularPreprocessor</code> <code>proc</code> or the ones in <code>sz_dict</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_emb_sz</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(8, 40),
 (8, 40),
 (3513, 40),
 (4608, 40),
 (24, 40),
 (5501, 40),
 (392, 40),
 (34, 40),
 (787082, 40),
 (2157569, 40),
 (6885, 40),
 (5, 40),
 (5, 40),
 (25, 40),
 (1089, 40),
 (9, 40),
 (10, 40),
 (239, 40),
 (5, 40),
 (51, 40),
 (169, 40),
 (44, 40)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="FGCNN">FGCNN<a class="anchor-link" href="#FGCNN"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Convolution -&gt; Max Pooling -&gt; Recombination</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ConvPoolRecombine" class="doc_header"><code>class</code> <code>ConvPoolRecombine</code><a href="https://github.com/numb3r33/fgcnn/tree/main/fgcnn/model.py#L21" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ConvPoolRecombine</code>(<strong><code>ch_in</code></strong>, <strong><code>ch_out</code></strong>, <strong><code>recomb_ch_out</code></strong>, <strong><code>out_wh</code></strong>, <strong><code>h</code></strong>, <strong><code>hp</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>input : ( N, C_in, H, W ), where w represents <code>k</code> ( emebdding size )
output: ( N, new_i, H / 2, W), where <code>2</code> represents max pool kernel size which is fixed as <code>2</code> for now.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FGCNN" class="doc_header"><code>class</code> <code>FGCNN</code><a href="https://github.com/numb3r33/fgcnn/tree/main/fgcnn/model.py#L70" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FGCNN</code>(<strong><code>emb_szs</code></strong>, <strong><code>conv_kernels</code></strong>, <strong><code>kernels</code></strong>, <strong><code>dense_layers</code></strong>, <strong><code>h</code></strong>, <strong><code>hp</code></strong>) :: <code>Module</code></p>
</blockquote>
<p>Same as <code>nn.Module</code>, but no need for subclasses to call <code>super().__init__</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

